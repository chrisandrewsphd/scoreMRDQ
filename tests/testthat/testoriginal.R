# Tests a selection of 10 scores to check for variations from the original

# the tolerance is usually relative (i.e. ⁠mean(abs(x - y) / mean(abs(y)) < tolerance⁠), except when the differences are very small, when it becomes absolute (i.e. ⁠mean(abs(x - y) < tolerance⁠).
tolerance_to_original <- 1e-4


thetas_original <- structure(
  list(
    ID = c("A", "B", "C", "D", "E", "F", "G", "H", "I", "J"),
    CV = c(-0.105427664, 1.090574836, 0.083784914, 0.223426289, 0.923451426,
           1.031696397, -0.242497337, -0.242478347, 0.57722743, 0.137717901),
    Col = c(-0.335398075, 1.113824032, -1.348019527, 0.473157311, 0.740306877,
            0.707693204, -0.232227895, -1.348019527, 1.069549738, 0.692617284),
    Cnt = c(0.347645355, 0.717139224, -1.401044292, 0.211609927, 1.251706389,
            0.477116703, 0.626564727, -0.908808922, 1.362864552, 0.320840958),
    SF = c(0.359831408, 0.379356088, -0.535784056, 0.239410412, 0.466076344,
           1.15247747, 0.38286063, -0.922500911, 1.763313222, 0.748938675),
    PF = c(0.276138775, 0.76304068, -0.642882912, 0.215046093, 0.778517405,
           1.481415991, 0.283093314, -0.737775296, 1.397629231, 0.245982096),
    MF = c(0.200930527, 0.550473217, -0.759417122, 0.176563527, 0.434722401,
           1.275698916, 0.328971833, -0.860124778, 1.974510097, 0.754642901),
    PS = c(-0.460083331, 0.724620232, 1.180851906, 0.278304187, 0.616011116,
           -0.577155802, 0.461971529, -1.502600911, 2.26299041, 0.840003216)),
  row.names = c(NA, -10L), class = "data.frame")

responses <- structure(
  list(
    ID = c("A", "B", "C", "D", "E", "F", "G", "H", "I", "J"),
    R01 = c(1L, 3L, 2L, 2L, 3L, 3L, 1L, 1L, 3L, 1L),
    R02 = c(1L, 2L, 1L, 2L, 2L, 3L, 0L, 1L, 2L, 0L),
    R03 = c(1L, 3L, 2L, 1L, 2L, 3L, 0L, 1L, 2L, 2L),
    R04 = c(1L, 3L, 2L, 2L, 4L, 4L, 2L, 1L, 3L, 3L),
    R05 = c(3L, 4L, 0L, 3L, 3L, 2L, NA, 1L, 2L, 2L),
    R06 = c(1L, 3L, 1L, 1L, 3L, 2L, 0L, 1L, 1L, 0L),
    R07 = c(2L, 3L, 0L, 1L, NA, 3L, 2L, 0L, 3L, 1L),
    R08 = c(2L, 4L, 2L, 2L, 2L, 3L, 3L, 2L, 3L, 2L),
    R09 = c(2L, 3L, 0L, 3L, 2L, 3L, 1L, 2L, 3L, 2L),
    R10 = c(0L, 3L, 3L, 1L, 3L, 3L, 3L, 0L, 1L, 3L),
    R11 = c(0L, 4L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L),
    CC01 = c(1L, 3L, 0L, 1L, 3L, 2L, 2L, 0L, 3L, 3L),
    CC02 = c(0L, 3L, 0L, 2L, 2L, 1L, 0L, 0L, 0L, 1L),
    CC03 = c(1L, 2L, 0L, 1L, 3L, 1L, 2L, 1L, 3L, 0L),
    CC04 = c(2L, 2L, 0L, 2L, 3L, 1L, 3L, 0L, 4L, 3L),
    CC05 = c(1L, 2L, 0L, 2L, 3L, 1L, NA, 0L, 2L, 1L),
    CC06 = c(1L, 2L, 0L, 0L, 2L, 2L, 2L, 0L, 2L, 0L),
    CC07 = c(1L, 2L, 0L, 0L, 3L, 3L, 0L, 0L, 3L, 1L),
    CC08 = c(1L, 2L, 0L, 1L, 3L, 2L, 2L, 0L, 3L, 2L),
    CC09 = c(0L, 2L, 0L, 1L, 1L, 3L, 0L, 0L, 3L, 1L),
    CC10 = c(1L, 1L, 0L, 1L, 2L, 1L, 0L, 0L, 3L, 1L),
    CC11 = c(2L, 1L, 0L, 2L, 1L, 1L, 1L, 0L, 3L, 2L),
    MP01 = c(2L, 1L, 2L, 2L, 3L, 3L, 3L, 0L, 4L, 3L),
    MP02 = c(2L, 3L, 2L, 2L, 2L, 2L, 3L, 1L, 3L, 2L),
    MP03 = c(3L, 3L, 2L, 2L, 3L, 4L, NA, 1L, 4L, 3L),
    MP04 = c(1L, 2L, 1L, 2L, 2L, 4L, 0L, 0L, 3L, 2L),
    MP05 = c(2L, 2L, 2L, 3L, 2L, 4L, 3L, 0L, 4L, 3L),
    MP06 = c(2L, 2L, 2L, 2L, 2L, 4L, 2L, 1L, 4L, 3L),
    MP07 = c(0L, 1L, 0L, 0L, 2L, 4L, 2L, 0L, 3L, 0L),
    MP08 = c(2L, 2L, 0L, 3L, 3L, 4L, 2L, 0L, 4L, 3L),
    MP09 = c(2L, 2L, 1L, 2L, 3L, 4L, 2L, 0L, 4L, 2L),
    MP10 = c(1L, 2L, 0L, 1L, 2L, 3L, 0L, 0L, 3L, 0L),
    MP11 = c(2L, 3L, 0L, 2L, 3L, 3L, 2L, 1L, 4L, 3L),
    MP12 = c(2L, 3L, 0L, 2L, 3L, 3L, 3L, 1L, 4L, 3L),
    MP13 = c(0L, 0L, 0L, 0L, 0L, NA, NA, 0L, 0L, 0L),
    MP14 = c(2L, NA, 0L, 2L, 0L, NA, NA, 0L, 2L, NA),
    MP15 = c(2L, NA, 0L, 2L, 1L, NA, NA, 0L, 3L, NA),
    MP16 = c(1L, 3L, 0L, 1L, 3L, 2L, 0L, 0L, 3L, 1L),
    MP17 = c(2L, 2L, NA, 2L, 4L, 3L, NA, 0L, 4L, 3L),
    MP18 = c(2L, 3L, NA, 3L, 3L, 3L, NA, 0L, 4L, 3L),
    MP19 = c(2L, 2L, 0L, 0L, 2L, 3L, 2L, 0L, 3L, 2L),
    MP20 = c(3L, 3L, 0L, 1L, 3L, 3L, NA, 0L, 4L, 3L),
    MP21 = c(2L, 3L, 0L, 1L, 3L, 3L, NA, 0L, 4L, 3L),
    MP22 = c(1L, 2L, 0L, 2L, 1L, 1L, 2L, 2L, 3L, 1L),
    MP23 = c(1L, 2L, 0L, 2L, 1L, 1L, NA, 2L, 3L, 2L),
    MP24 = c(1L, 2L, 0L, 2L, 1L, 1L, NA, 2L, 3L, 2L),
    MP25 = c(0L, 1L, 0L, 2L, 1L, 3L, 1L, 0L, 3L, 1L),
    MP26 = c(3L, 1L, 1L, 2L, 1L, 3L, 2L, 0L, 3L, 3L),
    MP27 = c(2L, 2L, 1L, 2L, 1L, 3L, 2L, 0L, 3L, 3L),
    MP28 = c(1L, 1L, 0L, 0L, 1L, 1L, 1L, 0L, 1L, 0L),
    MP29 = c(3L, 1L, 1L, 2L, 1L, NA, 1L, 0L, 3L, 1L),
    MP30 = c(2L, 1L, 1L, 1L, 1L, NA, 1L, 0L, 3L, 1L),
    LS01 = c(1L, 2L, 3L, 2L, 2L, 1L, 2L, 0L, 3L, 3L),
    LS02 = c(1L, 2L, 3L, 2L, 3L, 1L, 3L, 0L, 3L, 2L),
    LS03 = c(3L, 3L, 3L, 2L, 3L, 1L, 3L, 1L, 4L, 3L),
    LS04 = c(1L, 3L, 3L, 2L, 3L, 1L, 2L, 0L, 3L, 2L),
    LS05 = c(1L, 3L, 3L, 3L, 2L, 1L, 3L, 1L, 3L, 3L),
    LS06 = c(2L, 3L, 3L, 2L, 2L, 1L, 3L, 1L, 3L, 3L),
    LS07 = c(0L, 1L, 0L, 1L, 1L, 1L, 0L, 0L, 3L, 2L)),
  row.names = c(NA, -10L),
  class = "data.frame")

expect_equal(
  scoreMRDQ(responses)$thetas,
  thetas_original,
  tolerance = tolerance_to_original)
